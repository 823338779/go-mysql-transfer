var g=(u,o,C)=>new Promise((S,l)=>{var b=t=>{try{r(C.next(t))}catch(i){l(i)}},f=t=>{try{r(C.throw(t))}catch(i){l(i)}},r=t=>t.done?S(t.value):Promise.resolve(t.value).then(b,f);r((C=C.apply(u,o)).next())});import{B as $,a as q}from"./index.24728625.js";import{c as z,e as J,g as W}from"./index.e064266a.js";import{v as K}from"./index.85fdaa94.js";import{u as Q,n as X,i as Y,o as Z,p as x}from"./pipeline.data.13f2061e.js";import{_ as ee}from"./index.c0a3bc85.js";import{A as ae,c1 as ue,c2 as le,z as E,P as te,u as N,y as oe,a0 as _,B as h,a1 as w,a5 as a,k as e,ac as T,D as V,ao as I,aa as L,a4 as ne,ad as d}from"./vendor.52d192f7.js";import"./useWindowSizeFn.34f605a6.js";/* empty css               */const se=ae({name:"HttpRuleModal",components:{BasicModal:$,PlusOutlined:ue,MinusCircleOutlined:le},emits:["success","register"],setup(u,{emit:o}){const C=E(!0),S=E(),l=E({}),b=E(),f=E(),r=E(),t=te([{label:"Insert  Update  Delete",value:"0"},{label:"Insert  Update",value:"1"},{label:"Insert  Delete",value:"2"},{label:"Insert",value:"3"}]);let i,m,D;const[R,{setModalProps:H,closeModal:F}]=q(n=>g(this,null,function*(){if(S.value.resetFields(),b.value=[],f.value=[],r.value=[],m=n.pipeline.endpointId,i=n.pipeline.sourceId,H({confirmLoading:!1,width:1200}),C.value=!!(n==null?void 0:n.isUpdate),N(C)){yield Q(l.value,n.current),yield X(l.value,n.current);let c={schema:l.value.schema||""};yield p(c);let j={schema:l.value.schema||"",table:l.value.table||""};yield B(j)}else yield Y(l.value),yield Z(l.value);const v=[],M=yield z(i);for(let c=0;c<M.length;c++)v.push({label:M[c],value:M[c]});b.value=v})),A=oe(()=>N(C)?"\u7F16\u8F91\u89C4\u5219":"\u65B0\u589E\u89C4\u5219");function U(){return g(this,null,function*(){var n;(n=l.value.columnMappingGroups)==null||n.push({column:"",mapping:""})})}function k(n){return g(this,null,function*(){var v;(v=l.value.columnMappingGroups)==null||v.splice(n,1)})}function O(){return g(this,null,function*(){var n;(n=l.value.additionalColumnValueMappingGroups)==null||n.push({column:"",value:""})})}function G(n){return g(this,null,function*(){var v;(v=l.value.additionalColumnValueMappingGroups)==null||v.splice(n,1)})}function s(){return g(this,null,function*(){l.value.table="",l.value.excludeColumnList=[],l.value.columnMappingGroups=[],r.value=[];let n={schema:l.value.schema||""};yield p(n)})}function p(n){return g(this,null,function*(){const v=[],M=yield J(i,n);for(let c=0;c<M.length;c++)v.push({label:M[c],value:M[c]});f.value=v})}function y(){return g(this,null,function*(){l.value.excludeColumnList=[],l.value.columnMappingGroups=[];let n={schema:l.value.schema||"",table:l.value.table||""};yield B(n)})}function B(n){return g(this,null,function*(){D=yield W(i,n);const v=[];for(let M=0;M<D.columns.length;M++){let c=D.columns[M].name;v.push({label:c,value:c})}r.value=v})}function P(){return g(this,null,function*(){try{let n=!1;if(yield S.value.validate().then(()=>{n=!0}),!n)return;l.value.sourceId=i,l.value.endpointId=m,l.value.endpointType=8,l.value.type=0,l.value.typeName="\u89C4\u5219",yield K(l.value),o("success",JSON.parse(JSON.stringify(l.value))),F()}finally{H({confirmLoading:!1})}})}return{registerModal:R,getTitle:A,handleSubmit:P,formRef:S,formState:l,httpRuleFormRules:x,schemaOptions:b,tableOptions:f,columnOptions:r,receiveTypeOptions:t,onSchemaChange:s,onTableChange:y,addColumnNameMapping:U,delColumnNameMapping:k,addAdditionalColumnValue:O,delAdditionalColumnValue:G}}}),de=d("JSON"),me=d("\u8868\u8FBE\u5F0F"),re=d("\u5C0F\u5199"),ie=d("\u5927\u5199"),pe=d("\u9A7C\u5CF0"),fe=d(" \u5217\u540D\u6620\u5C04 "),ve=d(" \u9644\u52A0\u952E\u503C "),ce=d("yyyy-MM-dd"),_e=d("yyyy:MM:dd"),ye=d("yyyy/MM/dd"),Me=d("yyyy MM dd"),ge=d("MM/dd/yyyy"),Ce=d("yyyyMMdd"),he=d("yyyy-MM-dd HH:mm:ss.SSS"),Se=d("yyyy-MM-dd HH:mm:ss"),be=d("yyyy-MM-dd HH:mm"),Fe=d("yyyy:MM:dd HH:mm:ss.SSS"),Ee=d("yyyy:MM:dd HH:mm:ss"),De=d("yyyy:MM:dd HH:mm"),He=d("yyyy/MM/dd HH:mm:ss.SSS"),we=d("yyyy/MM/dd HH:mm:ss"),Re=d("yyyy/MM/dd HH:mm"),Ae=d("MM/dd/yyyy HH:mm:ss.SSS"),Ue=d("MM/dd/yyyy HH:mm:ss"),ke=d("MM/dd/yyyy HH:mm"),Oe=d("HTTP\u63A5\u53E3\u5C5E\u6027"),Ge=d("\u6D88\u606F\u4E2D\u5305\u542Bupdate\u4E4B\u524D\u6570\u636E");function Be(u,o,C,S,l,b){const f=_("a-select"),r=_("a-form-item"),t=_("a-col"),i=_("a-row"),m=_("a-select-option"),D=_("a-textarea"),R=_("PlusOutlined"),H=_("a-button"),F=_("a-input"),A=_("MinusCircleOutlined"),U=_("a-divider"),k=_("a-checkbox"),O=_("a-form"),G=_("BasicModal");return h(),w(G,ne(u.$attrs,{onRegister:u.registerModal,title:u.getTitle,onOk:u.handleSubmit}),{default:a(()=>[e(O,{ref:"formRef",model:u.formState,rules:u.httpRuleFormRules,"label-col":{style:{width:"120px"}},"wrapper-col":{span:16}},{default:a(()=>[e(i,null,{default:a(()=>[e(t,{span:12},{default:a(()=>[e(r,{label:"schema",name:"schema"},{default:a(()=>[e(f,{value:u.formState.schema,"onUpdate:value":o[0]||(o[0]=s=>u.formState.schema=s),options:u.schemaOptions,onChange:u.onSchemaChange,placeholder:"\u8BF7\u9009\u62E9schema"},null,8,["value","options","onChange"])]),_:1})]),_:1}),e(t,{span:12},{default:a(()=>[e(r,{label:"table",name:"table"},{default:a(()=>[e(f,{value:u.formState.table,"onUpdate:value":o[1]||(o[1]=s=>u.formState.table=s),options:u.tableOptions,onChange:u.onTableChange,placeholder:"\u8BF7\u9009\u62E9table"},null,8,["value","options","onChange"])]),_:1})]),_:1})]),_:1}),e(i,null,{default:a(()=>[e(t,{span:24},{default:a(()=>[e(r,{label:"\u6392\u9664\u7684\u5217",name:"excludeColumnList"},{default:a(()=>[e(f,{mode:"multiple",value:u.formState.excludeColumnList,"onUpdate:value":o[2]||(o[2]=s=>u.formState.excludeColumnList=s),options:u.columnOptions,placeholder:"\u8BF7\u9009\u62E9\u6392\u9664\u7684\u5217"},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),e(i,null,{default:a(()=>[e(t,{span:12},{default:a(()=>[e(r,{label:"\u6570\u636E\u7F16\u7801",name:"dataEncoder"},{default:a(()=>[e(f,{value:u.formState.dataEncoder,"onUpdate:value":o[3]||(o[3]=s=>u.formState.dataEncoder=s),placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u7F16\u7801"},{default:a(()=>[e(m,{value:"0"},{default:a(()=>[de]),_:1}),e(m,{value:"1"},{default:a(()=>[me]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t,{span:12},{default:a(()=>[u.formState.dataEncoder==="0"?(h(),w(r,{key:0,label:"\u5217\u540D\u8F6C\u6362",name:"columnNameFormatter"},{default:a(()=>[e(f,{value:u.formState.columnNameFormatter,"onUpdate:value":o[4]||(o[4]=s=>u.formState.columnNameFormatter=s),placeholder:"\u8BF7\u9009\u62E9\u5217\u540D\u8F6C\u6362"},{default:a(()=>[e(m,{value:"0"},{default:a(()=>[re]),_:1}),e(m,{value:"1"},{default:a(()=>[ie]),_:1}),e(m,{value:"2"},{default:a(()=>[pe]),_:1})]),_:1},8,["value"])]),_:1})):T("",!0)]),_:1})]),_:1}),e(i,null,{default:a(()=>[e(t,{span:24},{default:a(()=>[u.formState.dataEncoder==="1"?(h(),w(r,{key:0,label:"\u6570\u636E\u8868\u8FBE\u5F0F",name:"dataExpression"},{default:a(()=>[e(D,{value:u.formState.dataExpression,"onUpdate:value":o[5]||(o[5]=s=>u.formState.dataExpression=s),"auto-size":{minRows:2,maxRows:5}},null,8,["value"])]),_:1})):T("",!0)]),_:1})]),_:1}),e(i,null,{default:a(()=>[e(t,{span:24},{default:a(()=>[e(H,{type:"dashed",style:{"margin-left":"40px"},onClick:u.addColumnNameMapping},{default:a(()=>[e(R),fe]),_:1},8,["onClick"])]),_:1})]),_:1}),(h(!0),V(L,null,I(u.formState.columnMappingGroups,(s,p)=>(h(),w(i,{key:"row:"+p},{default:a(()=>[e(t,{span:10},{default:a(()=>[e(r,{label:"\u5217\u540D",name:["columnMappingGroups",p,"column"],rules:{required:!0,message:"\u5217\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:a(()=>[e(f,{value:u.formState.columnMappingGroups[p].column,"onUpdate:value":y=>u.formState.columnMappingGroups[p].column=y,options:u.columnOptions},null,8,["value","onUpdate:value","options"])]),_:2},1032,["name"])]),_:2},1024),e(t,{span:10},{default:a(()=>[e(r,{label:"\u6620\u5C04\u540D",name:["columnMappingGroups",p,"mapping"],rules:{required:!0,message:"\u6620\u5C04\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:a(()=>[e(F,{value:u.formState.columnMappingGroups[p].mapping,"onUpdate:value":y=>u.formState.columnMappingGroups[p].mapping=y},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(t,{span:4},{default:a(()=>[e(A,{class:"dynamic-delete-button",onClick:y=>u.delColumnNameMapping(p)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(i,null,{default:a(()=>[e(t,{span:24},{default:a(()=>[e(H,{type:"dashed",style:{"margin-left":"40px"},onClick:u.addAdditionalColumnValue},{default:a(()=>[e(R),ve]),_:1},8,["onClick"])]),_:1})]),_:1}),(h(!0),V(L,null,I(u.formState.additionalColumnValueMappingGroups,(s,p)=>(h(),w(i,{key:"row:"+p},{default:a(()=>[e(t,{span:10},{default:a(()=>[e(r,{label:"\u9644\u52A0\u5217",name:["additionalColumnValueMappingGroups",p,"column"],rules:{required:!0,message:"\u9644\u52A0\u5217\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:a(()=>[e(F,{value:u.formState.additionalColumnValueMappingGroups[p].column,"onUpdate:value":y=>u.formState.additionalColumnValueMappingGroups[p].column=y},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(t,{span:10},{default:a(()=>[e(r,{label:"\u9644\u52A0\u503C",name:["additionalColumnValueMappingGroups",p,"value"],rules:{required:!0,message:"\u9644\u52A0\u503C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:a(()=>[e(F,{value:u.formState.additionalColumnValueMappingGroups[p].value,"onUpdate:value":y=>u.formState.additionalColumnValueMappingGroups[p].value=y},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(t,{span:4},{default:a(()=>[e(A,{class:"dynamic-delete-button",onClick:y=>u.delAdditionalColumnValue(p)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(i,null,{default:a(()=>[e(t,{span:12},{default:a(()=>[e(r,{label:"\u65E5\u671F\u683C\u5F0F",name:"dateFormatter"},{default:a(()=>[e(f,{value:u.formState.dateFormatter,"onUpdate:value":o[6]||(o[6]=s=>u.formState.dateFormatter=s)},{default:a(()=>[e(m,{value:"0"},{default:a(()=>[ce]),_:1}),e(m,{value:"1"},{default:a(()=>[_e]),_:1}),e(m,{value:"2"},{default:a(()=>[ye]),_:1}),e(m,{value:"3"},{default:a(()=>[Me]),_:1}),e(m,{value:"4"},{default:a(()=>[ge]),_:1}),e(m,{value:"5"},{default:a(()=>[Ce]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t,{span:12},{default:a(()=>[e(r,{label:"\u65E5\u671F\u65F6\u95F4\u683C\u5F0F",name:"datetimeFormatter"},{default:a(()=>[e(f,{value:u.formState.datetimeFormatter,"onUpdate:value":o[7]||(o[7]=s=>u.formState.datetimeFormatter=s)},{default:a(()=>[e(m,{value:"0"},{default:a(()=>[he]),_:1}),e(m,{value:"1"},{default:a(()=>[Se]),_:1}),e(m,{value:"2"},{default:a(()=>[be]),_:1}),e(m,{value:"3"},{default:a(()=>[Fe]),_:1}),e(m,{value:"4"},{default:a(()=>[Ee]),_:1}),e(m,{value:"5"},{default:a(()=>[De]),_:1}),e(m,{value:"6"},{default:a(()=>[He]),_:1}),e(m,{value:"7"},{default:a(()=>[we]),_:1}),e(m,{value:"8"},{default:a(()=>[Re]),_:1}),e(m,{value:"9"},{default:a(()=>[Ae]),_:1}),e(m,{value:"10"},{default:a(()=>[Ue]),_:1}),e(m,{value:"11"},{default:a(()=>[ke]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),e(i,null,{default:a(()=>[e(t,{span:12},{default:a(()=>[e(r,{label:"\u76D1\u542C\u4E8B\u4EF6",name:"receiveType"},{default:a(()=>[e(f,{value:u.formState.receiveType,"onUpdate:value":o[8]||(o[8]=s=>u.formState.receiveType=s),options:u.receiveTypeOptions},null,8,["value","options"])]),_:1})]),_:1}),e(t,{span:12},{default:a(()=>[e(r,{label:"\u6392\u5E8F\u5217",name:"receiveTypes"},{default:a(()=>[e(f,{value:u.formState.orderColumn,"onUpdate:value":o[9]||(o[9]=s=>u.formState.orderColumn=s),options:u.columnOptions},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),e(U,{orientation:"left"},{default:a(()=>[Oe]),_:1}),e(i,null,{default:a(()=>[e(t,{span:12},{default:a(()=>[e(r,{label:"\u6570\u636E\u53C2\u6570\u540D\u79F0",name:"httpParameterName"},{default:a(()=>[e(F,{value:u.formState.httpParameterName,"onUpdate:value":o[10]||(o[10]=s=>u.formState.httpParameterName=s)},null,8,["value"])]),_:1})]),_:1}),e(t,{span:12},{default:a(()=>[e(r,{label:"",name:"httpReserveRawData"},{default:a(()=>[e(k,{checked:u.formState.httpReserveRawData,"onUpdate:checked":o[11]||(o[11]=s=>u.formState.httpReserveRawData=s)},{default:a(()=>[Ge]),_:1},8,["checked"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},16,["onRegister","title","onOk"])}var ze=ee(se,[["render",Be]]);export{ze as default};
