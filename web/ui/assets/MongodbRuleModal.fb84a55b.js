var M=(l,n,b)=>new Promise((h,u)=>{var S=t=>{try{m(b.next(t))}catch(r){u(r)}},f=t=>{try{m(b.throw(t))}catch(r){u(r)}},m=t=>t.done?h(t.value):Promise.resolve(t.value).then(S,f);m((b=b.apply(l,n)).next())});import{B as P,a as $}from"./index.24728625.js";import{c as q,e as z,g as J}from"./index.e064266a.js";import{v as W}from"./index.85fdaa94.js";import{u as K,g as Q,i as X,h as Y,m as Z}from"./pipeline.data.13f2061e.js";import{_ as x}from"./index.c0a3bc85.js";import{A as ee,c1 as ae,c2 as le,z as D,P as ue,u as B,y as te,a0 as y,B as H,a1 as G,a5 as a,k as e,D as T,ao as V,aa as I,a4 as oe,ad as d}from"./vendor.52d192f7.js";import"./useWindowSizeFn.34f605a6.js";/* empty css               */const ne=ee({name:"MongodbRuleModal",components:{BasicModal:P,PlusOutlined:ae,MinusCircleOutlined:le},emits:["success","register"],setup(l,{emit:n}){const b=D(!0),h=D(),u=D({}),S=D(),f=D(),m=D(),t=ue([{label:"Insert  Update  Delete",value:"0"},{label:"Insert  Update",value:"1"},{label:"Insert  Delete",value:"2"},{label:"Insert",value:"3"}]);let r,s,F;const[A,{setModalProps:C,closeModal:w}]=$(o=>M(this,null,function*(){if(h.value.resetFields(),S.value=[],f.value=[],m.value=[],s=o.pipeline.endpointId,r=o.pipeline.sourceId,C({confirmLoading:!1,width:1200}),b.value=!!(o==null?void 0:o.isUpdate),B(b)){yield K(u.value,o.current),yield Q(u.value,o.current);let c={schema:u.value.schema||""};yield R(c);let j={schema:u.value.schema||"",table:u.value.table||""};yield k(j)}else yield X(u.value),yield Y(u.value);const v=[],g=yield q(r);for(let c=0;c<g.length;c++)v.push({label:g[c],value:g[c]});S.value=v})),E=te(()=>B(b)?"\u7F16\u8F91\u89C4\u5219":"\u65B0\u589E\u89C4\u5219");function O(){return M(this,null,function*(){var o;(o=u.value.columnMappingGroups)==null||o.push({column:"",mapping:""})})}function U(o){return M(this,null,function*(){var v;(v=u.value.columnMappingGroups)==null||v.splice(o,1)})}function i(){return M(this,null,function*(){var o;(o=u.value.additionalColumnValueMappingGroups)==null||o.push({column:"",value:""})})}function p(o){return M(this,null,function*(){var v;(v=u.value.additionalColumnValueMappingGroups)==null||v.splice(o,1)})}function _(){return M(this,null,function*(){u.value.table="",u.value.excludeColumnList=[],u.value.columnMappingGroups=[],m.value=[];let o={schema:u.value.schema||""};yield R(o)})}function R(o){return M(this,null,function*(){const v=[],g=yield z(r,o);for(let c=0;c<g.length;c++)v.push({label:g[c],value:g[c]});f.value=v})}function L(){return M(this,null,function*(){u.value.excludeColumnList=[],u.value.columnMappingGroups=[];let o={schema:u.value.schema||"",table:u.value.table||""};yield k(o),u.value.mongodbCollection=u.value.table})}function k(o){return M(this,null,function*(){F=yield J(r,o);const v=[];for(let g=0;g<F.columns.length;g++){let c=F.columns[g].name;v.push({label:c,value:c})}m.value=v})}function N(){return M(this,null,function*(){try{let o=!1;if(yield h.value.validate().then(()=>{o=!0}),!o)return;u.value.sourceId=r,u.value.endpointId=s,u.value.endpointType=2,u.value.type=0,u.value.typeName="\u89C4\u5219",yield W(u.value),n("success",JSON.parse(JSON.stringify(u.value))),w()}finally{C({confirmLoading:!1})}})}return{registerModal:A,getTitle:E,handleSubmit:N,formRef:h,formState:u,mongodbRuleFormRules:Z,schemaOptions:S,tableOptions:f,columnOptions:m,receiveTypeOptions:t,onSchemaChange:_,onTableChange:L,addColumnNameMapping:O,delColumnNameMapping:U,addAdditionalColumnValue:i,delAdditionalColumnValue:p}}}),se=d("\u5C0F\u5199"),de=d("\u5927\u5199"),me=d("\u9A7C\u5CF0"),ie=d(" \u5217\u540D\u6620\u5C04 "),re=d(" \u9644\u52A0\u952E\u503C "),pe=d("yyyy-MM-dd"),fe=d("yyyy:MM:dd"),ve=d("yyyy/MM/dd"),ce=d("yyyy MM dd"),ye=d("MM/dd/yyyy"),_e=d("yyyyMMdd"),ge=d("yyyy-MM-dd HH:mm:ss.SSS"),Me=d("yyyy-MM-dd HH:mm:ss"),be=d("yyyy-MM-dd HH:mm"),Ce=d("yyyy:MM:dd HH:mm:ss.SSS"),he=d("yyyy:MM:dd HH:mm:ss"),Se=d("yyyy:MM:dd HH:mm"),Fe=d("yyyy/MM/dd HH:mm:ss.SSS"),De=d("yyyy/MM/dd HH:mm:ss"),He=d("yyyy/MM/dd HH:mm"),Ae=d("MM/dd/yyyy HH:mm:ss.SSS"),we=d("MM/dd/yyyy HH:mm:ss"),Ee=d("MM/dd/yyyy HH:mm"),Oe=d("MongoDB\u5C5E\u6027");function Ue(l,n,b,h,u,S){const f=y("a-select"),m=y("a-form-item"),t=y("a-col"),r=y("a-row"),s=y("a-select-option"),F=y("PlusOutlined"),A=y("a-button"),C=y("a-input"),w=y("MinusCircleOutlined"),E=y("a-divider"),O=y("a-form"),U=y("BasicModal");return H(),G(U,oe(l.$attrs,{onRegister:l.registerModal,title:l.getTitle,onOk:l.handleSubmit}),{default:a(()=>[e(O,{ref:"formRef",model:l.formState,rules:l.mongodbRuleFormRules,"label-col":{style:{width:"120px"}},"wrapper-col":{span:16}},{default:a(()=>[e(r,null,{default:a(()=>[e(t,{span:12},{default:a(()=>[e(m,{label:"schema",name:"schema"},{default:a(()=>[e(f,{value:l.formState.schema,"onUpdate:value":n[0]||(n[0]=i=>l.formState.schema=i),options:l.schemaOptions,onChange:l.onSchemaChange,placeholder:"\u8BF7\u9009\u62E9schema"},null,8,["value","options","onChange"])]),_:1})]),_:1}),e(t,{span:12},{default:a(()=>[e(m,{label:"table",name:"table"},{default:a(()=>[e(f,{value:l.formState.table,"onUpdate:value":n[1]||(n[1]=i=>l.formState.table=i),options:l.tableOptions,onChange:l.onTableChange,placeholder:"\u8BF7\u9009\u62E9table"},null,8,["value","options","onChange"])]),_:1})]),_:1})]),_:1}),e(r,null,{default:a(()=>[e(t,{span:24},{default:a(()=>[e(m,{label:"\u6392\u9664\u7684\u5217",name:"excludeColumnList"},{default:a(()=>[e(f,{mode:"multiple",value:l.formState.excludeColumnList,"onUpdate:value":n[2]||(n[2]=i=>l.formState.excludeColumnList=i),options:l.columnOptions,placeholder:"\u8BF7\u9009\u62E9\u6392\u9664\u7684\u5217"},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),e(r,null,{default:a(()=>[e(t,{span:24},{default:a(()=>[e(m,{label:"\u5217\u540D\u8F6C\u6362",name:"columnNameFormatter"},{default:a(()=>[e(f,{value:l.formState.columnNameFormatter,"onUpdate:value":n[3]||(n[3]=i=>l.formState.columnNameFormatter=i),placeholder:"\u8BF7\u9009\u62E9\u5217\u540D\u8F6C\u6362"},{default:a(()=>[e(s,{value:"0"},{default:a(()=>[se]),_:1}),e(s,{value:"1"},{default:a(()=>[de]),_:1}),e(s,{value:"2"},{default:a(()=>[me]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),e(r,null,{default:a(()=>[e(t,{span:24},{default:a(()=>[e(A,{type:"dashed",style:{"margin-left":"40px"},onClick:l.addColumnNameMapping},{default:a(()=>[e(F),ie]),_:1},8,["onClick"])]),_:1})]),_:1}),(H(!0),T(I,null,V(l.formState.columnMappingGroups,(i,p)=>(H(),G(r,{key:"row:"+p},{default:a(()=>[e(t,{span:10},{default:a(()=>[e(m,{label:"\u5217\u540D",name:["columnMappingGroups",p,"column"],rules:{required:!0,message:"\u5217\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:a(()=>[e(f,{value:l.formState.columnMappingGroups[p].column,"onUpdate:value":_=>l.formState.columnMappingGroups[p].column=_,options:l.columnOptions},null,8,["value","onUpdate:value","options"])]),_:2},1032,["name"])]),_:2},1024),e(t,{span:10},{default:a(()=>[e(m,{label:"\u6620\u5C04\u540D",name:["columnMappingGroups",p,"mapping"],rules:{required:!0,message:"\u6620\u5C04\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:a(()=>[e(C,{value:l.formState.columnMappingGroups[p].mapping,"onUpdate:value":_=>l.formState.columnMappingGroups[p].mapping=_},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(t,{span:4},{default:a(()=>[e(w,{class:"dynamic-delete-button",onClick:_=>l.delColumnNameMapping(p)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(r,null,{default:a(()=>[e(t,{span:24},{default:a(()=>[e(A,{type:"dashed",style:{"margin-left":"40px"},onClick:l.addAdditionalColumnValue},{default:a(()=>[e(F),re]),_:1},8,["onClick"])]),_:1})]),_:1}),(H(!0),T(I,null,V(l.formState.additionalColumnValueMappingGroups,(i,p)=>(H(),G(r,{key:"row:"+p},{default:a(()=>[e(t,{span:10},{default:a(()=>[e(m,{label:"\u9644\u52A0\u5217",name:["additionalColumnValueMappingGroups",p,"column"],rules:{required:!0,message:"\u9644\u52A0\u5217\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:a(()=>[e(C,{value:l.formState.additionalColumnValueMappingGroups[p].column,"onUpdate:value":_=>l.formState.additionalColumnValueMappingGroups[p].column=_},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(t,{span:10},{default:a(()=>[e(m,{label:"\u9644\u52A0\u503C",name:["additionalColumnValueMappingGroups",p,"value"],rules:{required:!0,message:"\u9644\u52A0\u503C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:a(()=>[e(C,{value:l.formState.additionalColumnValueMappingGroups[p].value,"onUpdate:value":_=>l.formState.additionalColumnValueMappingGroups[p].value=_},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(t,{span:4},{default:a(()=>[e(w,{class:"dynamic-delete-button",onClick:_=>l.delAdditionalColumnValue(p)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(r,null,{default:a(()=>[e(t,{span:12},{default:a(()=>[e(m,{label:"\u65E5\u671F\u683C\u5F0F",name:"dateFormatter"},{default:a(()=>[e(f,{value:l.formState.dateFormatter,"onUpdate:value":n[4]||(n[4]=i=>l.formState.dateFormatter=i)},{default:a(()=>[e(s,{value:"0"},{default:a(()=>[pe]),_:1}),e(s,{value:"1"},{default:a(()=>[fe]),_:1}),e(s,{value:"2"},{default:a(()=>[ve]),_:1}),e(s,{value:"3"},{default:a(()=>[ce]),_:1}),e(s,{value:"4"},{default:a(()=>[ye]),_:1}),e(s,{value:"5"},{default:a(()=>[_e]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t,{span:12},{default:a(()=>[e(m,{label:"\u65E5\u671F\u65F6\u95F4\u683C\u5F0F",name:"datetimeFormatter"},{default:a(()=>[e(f,{value:l.formState.datetimeFormatter,"onUpdate:value":n[5]||(n[5]=i=>l.formState.datetimeFormatter=i)},{default:a(()=>[e(s,{value:"0"},{default:a(()=>[ge]),_:1}),e(s,{value:"1"},{default:a(()=>[Me]),_:1}),e(s,{value:"2"},{default:a(()=>[be]),_:1}),e(s,{value:"3"},{default:a(()=>[Ce]),_:1}),e(s,{value:"4"},{default:a(()=>[he]),_:1}),e(s,{value:"5"},{default:a(()=>[Se]),_:1}),e(s,{value:"6"},{default:a(()=>[Fe]),_:1}),e(s,{value:"7"},{default:a(()=>[De]),_:1}),e(s,{value:"8"},{default:a(()=>[He]),_:1}),e(s,{value:"9"},{default:a(()=>[Ae]),_:1}),e(s,{value:"10"},{default:a(()=>[we]),_:1}),e(s,{value:"11"},{default:a(()=>[Ee]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),e(r,null,{default:a(()=>[e(t,{span:12},{default:a(()=>[e(m,{label:"\u76D1\u542C\u4E8B\u4EF6",name:"receiveType"},{default:a(()=>[e(f,{value:l.formState.receiveType,"onUpdate:value":n[6]||(n[6]=i=>l.formState.receiveType=i),options:l.receiveTypeOptions},null,8,["value","options"])]),_:1})]),_:1}),e(t,{span:12},{default:a(()=>[e(m,{label:"\u6392\u5E8F\u5217",name:"receiveTypes"},{default:a(()=>[e(f,{value:l.formState.orderColumn,"onUpdate:value":n[7]||(n[7]=i=>l.formState.orderColumn=i),options:l.columnOptions},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),e(E,{orientation:"left"},{default:a(()=>[Oe]),_:1}),e(r,null,{default:a(()=>[e(t,{span:12},{default:a(()=>[e(m,{label:"Database",name:"mongodbDatabase"},{default:a(()=>[e(C,{value:l.formState.mongodbDatabase,"onUpdate:value":n[8]||(n[8]=i=>l.formState.mongodbDatabase=i)},null,8,["value"])]),_:1})]),_:1}),e(t,{span:12},{default:a(()=>[e(m,{label:"Collection",name:"mongodbCollection"},{default:a(()=>[e(C,{value:l.formState.mongodbCollection,"onUpdate:value":n[9]||(n[9]=i=>l.formState.mongodbCollection=i)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},16,["onRegister","title","onOk"])}var je=x(ne,[["render",Ue]]);export{je as default};
